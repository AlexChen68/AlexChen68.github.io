import{_ as s,o as a,c as n,Q as e}from"./chunks/framework.01af844e.js";const h=JSON.parse('{"title":"Zookeeper 安装部署","description":"","frontmatter":{"title":"Zookeeper 安装部署","date":"2023-10-18T00:00:00.000Z","order":102},"headers":[],"relativePath":"devops/deploy/zookeeper.md","filePath":"devops/deploy/zookeeper.md","lastUpdated":1740013072000}'),p={name:"devops/deploy/zookeeper.md"},l=e(`<h2 id="独立模式部署" tabindex="-1">独立模式部署 <a class="header-anchor" href="#独立模式部署" aria-label="Permalink to &quot;独立模式部署&quot;">​</a></h2><h3 id="下载-zookeeper" tabindex="-1">下载 ZooKeeper <a class="header-anchor" href="#下载-zookeeper" aria-label="Permalink to &quot;下载 ZooKeeper&quot;">​</a></h3><p>下载地址：<a href="http://zookeeper.apache.org/releases.html" target="_blank" rel="noreferrer">http://zookeeper.apache.org/releases.html</a></p><p>通常选择最新的 stable 版本。</p><h3 id="解压缩" tabindex="-1">解压缩 <a class="header-anchor" href="#解压缩" aria-label="Permalink to &quot;解压缩&quot;">​</a></h3><p>解压缩到某一目录 (这里以 /opt 目录为例)，可以修改解压缩后的文件夹名称</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 解压缩</span></span>
<span class="line"><span style="color:#B392F0;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-zxf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/apache-zookeeper-3.8.3-bin.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 重命名</span></span>
<span class="line"><span style="color:#B392F0;">mv</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/apache-zookeeper-3.8.3-bin</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/zookeeper</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 解压缩</span></span>
<span class="line"><span style="color:#6F42C1;">tar</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-zxf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/apache-zookeeper-3.8.3-bin.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 重命名</span></span>
<span class="line"><span style="color:#6F42C1;">mv</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/apache-zookeeper-3.8.3-bin</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/zookeeper</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="添加配置文件" tabindex="-1">添加配置文件 <a class="header-anchor" href="#添加配置文件" aria-label="Permalink to &quot;添加配置文件&quot;">​</a></h3><p>进入配置目录</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/zookeeper/conf</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/zookeeper/conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>创建配置文件 <code>zoo.cfg</code></p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">vi</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zoo.cfg</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">vi</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zoo.cfg</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>添加配置信息，</p><div class="language-ini vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">tickTime</span><span style="color:#E1E4E8;">=2000</span></span>
<span class="line"><span style="color:#F97583;">dataDir</span><span style="color:#E1E4E8;">=/var/lib/zookeeper</span></span>
<span class="line"><span style="color:#F97583;">dataLogDir</span><span style="color:#E1E4E8;">=/var/lib/log</span></span>
<span class="line"><span style="color:#F97583;">clientPort</span><span style="color:#E1E4E8;">=2181</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">tickTime</span><span style="color:#24292E;">=2000</span></span>
<span class="line"><span style="color:#D73A49;">dataDir</span><span style="color:#24292E;">=/var/lib/zookeeper</span></span>
<span class="line"><span style="color:#D73A49;">dataLogDir</span><span style="color:#24292E;">=/var/lib/log</span></span>
<span class="line"><span style="color:#D73A49;">clientPort</span><span style="color:#24292E;">=2181</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>tickTime=2000（Zookeeper 最小时间单元，单位毫秒 (ms)，默认值为 3000）。</p><p>dataDir=/var/lib/zookeeper（Zookeeper 服务器存储快照文件的目录，必须配置）。</p><p>dataLogDir=/var/lib/log（Zookeeper 服务器存储事务日志的目录，默认为 dataDir）。</p><p>clientPort=2181（服务器对外服务端口，一般设置为 2181）。</p></blockquote><h3 id="zookeeper-启停" tabindex="-1">ZooKeeper 启停 <a class="header-anchor" href="#zookeeper-启停" aria-label="Permalink to &quot;ZooKeeper 启停&quot;">​</a></h3><p>首先进入 zookeeper 的 bin 目录下，</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/zookeeper/bin</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/zookeeper/bin</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>调用 <code>zkServer.sh</code> 脚本，可以对 zookeeper 进行如下操作：</p><ul><li>启动 ZooKeeper 服务：<code>./zkServer.sh start</code></li><li>查看 ZooKeeper 服务状态：<code>./zkServer.sh status</code></li><li>停止 ZooKeeper 服务：<code>./zkServer.sh stop</code></li><li>重启 ZooKeeper 服务：<code>./zkServer.sh restart</code></li></ul><h3 id="连接-zookeeper" tabindex="-1">连接 ZooKeeper <a class="header-anchor" href="#连接-zookeeper" aria-label="Permalink to &quot;连接 ZooKeeper&quot;">​</a></h3><p>首先进入 zookeeper 的 bin 目录下。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/zookeeper/bin</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/zookeeper/bin</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>调用 <code>zkCli.sh</code> 脚本，连接到 zookeeper</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">./zkCli.sh</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-server</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">127.0</span><span style="color:#9ECBFF;">.0.1:2181</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">./zkCli.sh</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-server</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">127.0</span><span style="color:#032F62;">.0.1:2181</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>更多 cli 命令，参考 <a href="https://zookeeper.apache.org/doc/r3.8.3/zookeeperCLI.html" target="_blank" rel="noreferrer">zookeeperCLI</a>。</p><h2 id="集群部署" tabindex="-1">集群部署 <a class="header-anchor" href="#集群部署" aria-label="Permalink to &quot;集群部署&quot;">​</a></h2><h3 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h3><p>最少三台服务器（奇数），打通网络，配置 ssh 免密登录，安装 JDK；</p><p>配置 hosts</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">192.168.188.128 node1</span></span>
<span class="line"><span style="color:#e1e4e8;">192.168.188.129 node2</span></span>
<span class="line"><span style="color:#e1e4e8;">192.168.188.130 node3</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">192.168.188.128 node1</span></span>
<span class="line"><span style="color:#24292e;">192.168.188.129 node2</span></span>
<span class="line"><span style="color:#24292e;">192.168.188.130 node3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>关闭防火墙</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stop</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">firewalld</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">disable</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">firewalld</span></span>
<span class="line"><span style="color:#B392F0;">setenforce</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stop</span><span style="color:#24292E;"> </span><span style="color:#032F62;">firewalld</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">disable</span><span style="color:#24292E;"> </span><span style="color:#032F62;">firewalld</span></span>
<span class="line"><span style="color:#6F42C1;">setenforce</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>可以参考 <a href="./vm-cluster.html">集群环境配置</a></p><h3 id="配置文件" tabindex="-1">配置文件 <a class="header-anchor" href="#配置文件" aria-label="Permalink to &quot;配置文件&quot;">​</a></h3><p>在独立模式部署的前提下，修改配置文件如下</p><div class="language-ini vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">tickTime</span><span style="color:#E1E4E8;">=2000</span></span>
<span class="line"><span style="color:#F97583;">dataDir</span><span style="color:#E1E4E8;">=/var/lib/zookeeper</span></span>
<span class="line"><span style="color:#F97583;">clientPort</span><span style="color:#E1E4E8;">=2181</span></span>
<span class="line"><span style="color:#F97583;">initLimit</span><span style="color:#E1E4E8;">=5</span></span>
<span class="line"><span style="color:#F97583;">syncLimit</span><span style="color:#E1E4E8;">=2</span></span>
<span class="line"><span style="color:#F97583;">server.1</span><span style="color:#E1E4E8;">=node1:2888:3888</span></span>
<span class="line"><span style="color:#F97583;">server.2</span><span style="color:#E1E4E8;">=node2:2888:3888</span></span>
<span class="line"><span style="color:#F97583;">server.3</span><span style="color:#E1E4E8;">=node3:2888:3888</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">tickTime</span><span style="color:#24292E;">=2000</span></span>
<span class="line"><span style="color:#D73A49;">dataDir</span><span style="color:#24292E;">=/var/lib/zookeeper</span></span>
<span class="line"><span style="color:#D73A49;">clientPort</span><span style="color:#24292E;">=2181</span></span>
<span class="line"><span style="color:#D73A49;">initLimit</span><span style="color:#24292E;">=5</span></span>
<span class="line"><span style="color:#D73A49;">syncLimit</span><span style="color:#24292E;">=2</span></span>
<span class="line"><span style="color:#D73A49;">server.1</span><span style="color:#24292E;">=node1:2888:3888</span></span>
<span class="line"><span style="color:#D73A49;">server.2</span><span style="color:#24292E;">=node2:2888:3888</span></span>
<span class="line"><span style="color:#D73A49;">server.3</span><span style="color:#24292E;">=node3:2888:3888</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="指定节点-id" tabindex="-1">指定节点 id <a class="header-anchor" href="#指定节点-id" aria-label="Permalink to &quot;指定节点 id&quot;">​</a></h3><p>使用 echo 命令，写入希望的节点 id 到 zoo.cfg 配置的 dataDir 目录下的 myid 文件中：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/zookeeper/data/myid</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/zookeeper/data/myid</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/zookeeper/data/myid</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/zookeeper/data/myid</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/zookeeper/data/myid</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/zookeeper/data/myid</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="配置-zookeeper-启动脚本" tabindex="-1">配置 Zookeeper 启动脚本 <a class="header-anchor" href="#配置-zookeeper-启动脚本" aria-label="Permalink to &quot;配置 Zookeeper 启动脚本&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">vi</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/init.d/zookeeper</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">vi</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/init.d/zookeeper</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="color:#E1E4E8;">ZK_HOME</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;/opt/zookeeper&#39;</span></span>
<span class="line"><span style="color:#F97583;">case</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">$1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span></span>
<span class="line"><span style="color:#E1E4E8;">start)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;---------- zookeeper 启动 ------------&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">	$ZK_HOME/bin/zkServer.sh </span><span style="color:#9ECBFF;">start</span></span>
<span class="line"><span style="color:#E1E4E8;">;;</span></span>
<span class="line"><span style="color:#E1E4E8;">stop)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;---------- zookeeper 停止 ------------&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">	$ZK_HOME/bin/zkServer.sh </span><span style="color:#9ECBFF;">stop</span></span>
<span class="line"><span style="color:#E1E4E8;">;;</span></span>
<span class="line"><span style="color:#E1E4E8;">restart)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;---------- zookeeper 重启 ------------&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">	$ZK_HOME/bin/zkServer.sh </span><span style="color:#9ECBFF;">restart</span></span>
<span class="line"><span style="color:#E1E4E8;">;;</span></span>
<span class="line"><span style="color:#E1E4E8;">status)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;---------- zookeeper 状态 ------------&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">	$ZK_HOME/bin/zkServer.sh </span><span style="color:#9ECBFF;">status</span></span>
<span class="line"><span style="color:#E1E4E8;">;;</span></span>
<span class="line"><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Usage: </span><span style="color:#79B8FF;">$0</span><span style="color:#9ECBFF;"> {start|stop|restart|status}&quot;</span></span>
<span class="line"><span style="color:#F97583;">esac</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="color:#24292E;">ZK_HOME</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;/opt/zookeeper&#39;</span></span>
<span class="line"><span style="color:#D73A49;">case</span><span style="color:#24292E;"> </span><span style="color:#E36209;">$1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span></span>
<span class="line"><span style="color:#24292E;">start)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;---------- zookeeper 启动 ------------&quot;</span></span>
<span class="line"><span style="color:#24292E;">	$ZK_HOME/bin/zkServer.sh </span><span style="color:#032F62;">start</span></span>
<span class="line"><span style="color:#24292E;">;;</span></span>
<span class="line"><span style="color:#24292E;">stop)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;---------- zookeeper 停止 ------------&quot;</span></span>
<span class="line"><span style="color:#24292E;">	$ZK_HOME/bin/zkServer.sh </span><span style="color:#032F62;">stop</span></span>
<span class="line"><span style="color:#24292E;">;;</span></span>
<span class="line"><span style="color:#24292E;">restart)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;---------- zookeeper 重启 ------------&quot;</span></span>
<span class="line"><span style="color:#24292E;">	$ZK_HOME/bin/zkServer.sh </span><span style="color:#032F62;">restart</span></span>
<span class="line"><span style="color:#24292E;">;;</span></span>
<span class="line"><span style="color:#24292E;">status)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;---------- zookeeper 状态 ------------&quot;</span></span>
<span class="line"><span style="color:#24292E;">	$ZK_HOME/bin/zkServer.sh </span><span style="color:#032F62;">status</span></span>
<span class="line"><span style="color:#24292E;">;;</span></span>
<span class="line"><span style="color:#D73A49;">*</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Usage: </span><span style="color:#005CC5;">$0</span><span style="color:#032F62;"> {start|stop|restart|status}&quot;</span></span>
<span class="line"><span style="color:#D73A49;">esac</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="启停服务" tabindex="-1">启停服务 <a class="header-anchor" href="#启停服务" aria-label="Permalink to &quot;启停服务&quot;">​</a></h3><ul><li>启动 ZooKeeper 服务：<code>service zookeeper start</code></li><li>查看 ZooKeeper 服务状态：<code>service zookeeper status</code></li><li>停止 ZooKeeper 服务：<code>service zookeeper stop</code></li><li>重启 ZooKeeper 服务：<code>service zookeeper restart</code></li></ul><p>启动后查看状态，如下为启动成功示例，Mode 表示是领导节点还是从节点</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@node1 bin]# service zookeeper status</span></span>
<span class="line"><span style="color:#B392F0;">----------</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zookeeper</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">状态</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">------------</span></span>
<span class="line"><span style="color:#B392F0;">/bin/java</span></span>
<span class="line"><span style="color:#B392F0;">ZooKeeper</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">JMX</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">enabled</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">by</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">default</span></span>
<span class="line"><span style="color:#B392F0;">Using</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">config:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/zookeeper/bin/../conf/zoo.cfg</span></span>
<span class="line"><span style="color:#B392F0;">Client</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">port</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">found:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2181</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Client</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">address:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost.</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Client</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SSL:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span><span style="color:#9ECBFF;">.</span></span>
<span class="line"><span style="color:#B392F0;">Mode:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">leader</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@node1 bin]# service zookeeper status</span></span>
<span class="line"><span style="color:#6F42C1;">----------</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zookeeper</span><span style="color:#24292E;"> </span><span style="color:#032F62;">状态</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">------------</span></span>
<span class="line"><span style="color:#6F42C1;">/bin/java</span></span>
<span class="line"><span style="color:#6F42C1;">ZooKeeper</span><span style="color:#24292E;"> </span><span style="color:#032F62;">JMX</span><span style="color:#24292E;"> </span><span style="color:#032F62;">enabled</span><span style="color:#24292E;"> </span><span style="color:#032F62;">by</span><span style="color:#24292E;"> </span><span style="color:#032F62;">default</span></span>
<span class="line"><span style="color:#6F42C1;">Using</span><span style="color:#24292E;"> </span><span style="color:#032F62;">config:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/zookeeper/bin/../conf/zoo.cfg</span></span>
<span class="line"><span style="color:#6F42C1;">Client</span><span style="color:#24292E;"> </span><span style="color:#032F62;">port</span><span style="color:#24292E;"> </span><span style="color:#032F62;">found:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2181</span><span style="color:#032F62;">.</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Client</span><span style="color:#24292E;"> </span><span style="color:#032F62;">address:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost.</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Client</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SSL:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#032F62;">.</span></span>
<span class="line"><span style="color:#6F42C1;">Mode:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">leader</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="连接-zookeeper-1" tabindex="-1">连接 ZooKeeper <a class="header-anchor" href="#连接-zookeeper-1" aria-label="Permalink to &quot;连接 ZooKeeper&quot;">​</a></h3><p>首先进入 zookeeper 的 bin 目录下。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/zookeeper/bin</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/zookeeper/bin</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>调用 <code>zkCli.sh</code> 脚本，连接到 zookeeper</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">./zkCli.sh</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-server</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">127.0</span><span style="color:#9ECBFF;">.0.1:2181</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">./zkCli.sh</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-server</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">127.0</span><span style="color:#032F62;">.0.1:2181</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>在一个节点 set 数据，查看其他节点是否可以查看到该数据，以验证集群是否部署成功。</p><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-label="Permalink to &quot;参考资料&quot;">​</a></h2><ul><li><a href="https://zookeeper.apache.org/doc/r3.8.3/zookeeperStarted.html" target="_blank" rel="noreferrer">官方文档</a></li><li><a href="https://blog.csdn.net/wang_dian1/article/details/131680214" target="_blank" rel="noreferrer">zookeeper 集群</a></li></ul>`,55),o=[l];function r(c,t,i,y,d,E){return a(),n("div",null,o)}const u=s(p,[["render",r]]);export{h as __pageData,u as default};
